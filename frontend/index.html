<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ğŸŒŒ Ù„ÙˆØ­Ø© Ø³Ø±Ø§Ø¬ Ø§Ù„Ø£Ø³Ø·ÙˆØ±ÙŠØ©</title>
<style>
body { font-family: monospace; background: #0d0d0d; color: #00ff99; margin:0; padding:20px; }
h1 { color: #ffdd00; }
table { width:100%; border-collapse: collapse; margin-top:10px; }
th, td { border:1px solid #00ff99; padding:5px; text-align:center; }
th { background:#111; color:#ffdd00; }
.online { color:#00ff99; font-weight:bold; }
.offline { color:#ff3300; font-weight:bold; }
button { background:#00ff99;color:#0d0d0d;border:none;padding:5px 10px;cursor:pointer;margin:2px; }
button:hover { background:#33ffbb; }
#log { background:#111; padding:10px; border:1px solid #00ff99; height:200px; overflow:auto; margin-top:10px; }
</style>
</head>
<body>
<h1>ğŸŒŒ Ù„ÙˆØ­Ø© Ø³Ø±Ø§Ø¬ Ø§Ù„Ø£Ø³Ø·ÙˆØ±ÙŠØ©</h1>
<table id="services">
<thead>
<tr>
<th>ID</th><th>Ø§Ø³Ù… Ø§Ù„Ø®Ø¯Ù…Ø©</th><th>Ø§Ù„Ø­Ø§Ù„Ø©</th><th>CPU</th><th>MEM</th><th>Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªØ´ØºÙŠÙ„</th>
</tr>
</thead>
<tbody>
<tr><td colspan="6">Ø¬Ø§Ø±Ù Ø§Ù„ØªØ­Ù…ÙŠÙ„...</td></tr>
</tbody>
</table>

<h2>ğŸ“œ Ø³Ø¬Ù„Ø§Øª siraj-backend</h2>
<button onclick="fetchLogs()">â¬‡ï¸ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø³Ø¬Ù„Ø§Øª</button>
<pre id="log">Ø¬Ø§Ø±Ù Ø§Ù„ØªØ­Ù…ÙŠÙ„...</pre>

<script>
const PORT = 9090;

async function fetchServices(){
    try{
        const res = await fetch(`http://localhost:${PORT}/status`);
        const data = await res.json();
        const tbody = document.querySelector("#services tbody");
        tbody.innerHTML = "";
        data.forEach(svc=>{
            const tr = document.createElement("tr");
            tr.innerHTML = `
            <td>${svc.id}</td>
            <td>${svc.name}</td>
            <td class="${svc.status==='online'?'online':'offline'}">${svc.status}</td>
            <td>${svc.cpu}%</td>
            <td>${svc.mem} MB</td>
            <td><button onclick="restart('${svc.name}')">ğŸ”„ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªØ´ØºÙŠÙ„</button></td>
            `;
            tbody.appendChild(tr);
        });
    }catch(e){
        document.querySelector("#services tbody").innerHTML = "<tr><td colspan='6'>âŒ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù€ siraj-backend</td></tr>";
    }
}

async function fetchLogs(){
    try{
        const res = await fetch(`http://localhost:${PORT}/logs`);
        const text = await res.text();
        document.getElementById('log').textContent = text;
    }catch(e){
        document.getElementById('log').textContent = 'âŒ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù€ siraj-backend Ø¹Ù„Ù‰ Ø§Ù„Ø¨ÙˆØ±Øª '+PORT;
    }
}

async function restart(name){
    try{
        await fetch(`http://localhost:${PORT}/restart/${name}`, { method:'POST' });
        alert("ğŸ”„ Ø£Ø¹ÙŠØ¯ ØªØ´ØºÙŠÙ„ " + name);
        fetchServices();
    }catch(e){
        alert("âŒ ÙØ´Ù„ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªØ´ØºÙŠÙ„: "+name);
    }
}

fetchServices();
fetchLogs();
setInterval(fetchServices,5000);
setInterval(fetchLogs,5000);
</script>
</body>
</html>
